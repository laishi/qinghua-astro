


<!-- dat -->
---
import HeaderParallax from "./Header/HeaderParallax.astro";
import Waves from "./Header/Waves.astro";
import Menu from "./Header/Menu.astro";

import CardParallax from "./CardParallax.astro";
import CardGlass from "./CardGlass.astro";

import Footer from "./Footer.astro";


const templates = [
  { id: "01", name: "01-add-life-health-fitness-free-bootstrap-html5-template", title: "Life Health Template", keywords: ["å¥åº·å…»ç”Ÿ", "å¥èº«å¡‘å½¢", "åŒ»ç–—ä¿å¥", "ðŸ”¥ 3688"] },
  { id: "02", name: "02-reveal", title: "é€šç”¨æ¨¡æ¿", keywords: ["ä¼ä¸šå±•ç¤º", "å“ç‰Œå®£ä¼ ", "å¤šåœºæ™¯", "ðŸ”¥ 2875"] },
  { id: "03", name: "03-agile-agency-free-bootstrap-web-template", title: "Agency Free Template", keywords: ["å¹¿å‘Šä»£ç†", "åˆ›æ„è®¾è®¡", "æœåŠ¡è¡Œä¸š", "ðŸ”¥ 4521"] },
  { id: "04", name: "04-amaze-photography-bootstrap-html5-template", title: "Photography Bootstrap Template", keywords: ["æ‘„å½±ä½œå“", "è§†è§‰è‰ºæœ¯", "å½±åƒå±•ç¤º", "ðŸ”¥ 5123"] },
  { id: "05", name: "05-aroma-beauty-and-spa-responsive-bootstrap-template", title: "Beauty And Template", keywords: ["ç¾Žå®¹æŠ¤è‚¤", "æ°´ç–—å…»ç”Ÿ", "å¥åº·ç®¡ç†", "ðŸ”¥ 4987"] },
  { id: "06", name: "06-avenger-multi-purpose-responsive-html5-bootstrap-template", title: "Multi Purpose Template", keywords: ["ä¼ä¸šå®˜ç½‘", "äº§å“å±•ç¤º", "å“ç‰Œè¥é”€", "ðŸ”¥ 6754"] },
  { id: "07", name: "07-b-school-free-education-html5-website-template", title: "School Free Template", keywords: ["æ•™è‚²åŸ¹è®­", "åœ¨çº¿è¯¾ç¨‹", "å­¦æœ¯æœºæž„", "ðŸ”¥ 3892"] },
  { id: "08", name: "08-beauty-salon-bootstrap-html5-template", title: "Salon Bootstrap Template", keywords: ["ç¾Žå‘é€ åž‹", "ç¾Žå®¹ç¾Žç”²", "å½¢è±¡è®¾è®¡", "ðŸ”¥ 4231"] },
  { id: "09", name: "09-brand-html5-app-landing-page-responsive-web-template", title: "Html5 App Template", keywords: ["ç§»åŠ¨åº”ç”¨", "äº§å“æŽ¨å¹¿", "ä¸‹è½½é¡µé¢", "ðŸ”¥ 5876"] },
  { id: "10", name: "10-businessline-corporate-portfolio-bootstrap-responsive-web-template", title: "Corporate Portfolio Template", keywords: ["ä¼ä¸šå½¢è±¡", "æ¡ˆä¾‹å±•ç¤º", "å“ç‰Œå»ºè®¾", "ðŸ”¥ 5321"] },
  { id: "11", name: "11-businessr-corporate-bootstrap-responsive-web-template", title: "Corporate Bootstrap Template", keywords: ["å•†åŠ¡åŠžå…¬", "ä¼ä¸šå®£ä¼ ", "å“ç‰Œå®˜ç½‘", "ðŸ”¥ 4876"] },
  { id: "12", name: "12-car-repair-html5-bootstrap-template", title: "Repair Html5 Template", keywords: ["æ±½è½¦ç»´ä¿®", "4Såº—é“º", "ä¿å…»æœåŠ¡", "ðŸ”¥ 3567"] },
  { id: "13", name: "13-car-zone-automobile-bootstrap-responsive-web-template", title: "Zone Automobile Template", keywords: ["æ±½è½¦é”€å”®", "æ–°è½¦å±•ç¤º", "äºŒæ‰‹è½¦", "ðŸ”¥ 4123"] },
  { id: "14", name: "14-city-square-bootstrap-responsive-web-template", title: "Square Bootstrap Template", keywords: ["åŸŽå¸‚ç”Ÿæ´»", "å•†ä¸šå¹¿åœº", "ç»¼åˆä½“", "ðŸ”¥ 2987"] },
  { id: "15", name: "15-cloud-hosting-free-bootstrap-responsive-website-template", title: "Hosting Free Template", keywords: ["äº‘æœåŠ¡", "æœåŠ¡å™¨", "è™šæ‹Ÿä¸»æœº", "ðŸ”¥ 5432"] },
  { id: "16", name: "16-clouds-html5-multipurpose-landing-page-template", title: "Html5 Multipurpose Template", keywords: ["äº§å“å‘å¸ƒ", "æ´»åŠ¨å®£ä¼ ", "è¥é”€æŽ¨å¹¿", "ðŸ”¥ 4985"] },
  { id: "17", name: "17-coffee-shop-free-html5-template", title: "Shop Free Template", keywords: ["å’–å•¡é¤é¥®", "ä¼‘é—²ç©ºé—´", "ç”œå“çƒ˜ç„™", "ðŸ”¥ 3765"] },
  { id: "18", name: "18-creative-free-responsive-html5-business-template", title: "Free Responsive Template", keywords: ["åˆ›æ„è®¾è®¡", "å¹¿å‘Šä¼ åª’", "å“ç‰Œç­–åˆ’", "ðŸ”¥ 4321"] },
  { id: "19", name: "19-darktouch-corporate-portfolio-bootstrap-responsive-web-template", title: "Corporate Portfolio Template", keywords: ["é«˜ç«¯ä¼ä¸š", "å“ç‰Œè§†è§‰", "æ¡ˆä¾‹åˆé›†", "ðŸ”¥ 5123"] },
  { id: "20", name: "20-delite-music-html5-bootstrap-responsive-web-template", title: "Music Html5 Template", keywords: ["éŸ³ä¹è‰ºæœ¯", "æ¼”å‡ºæ´»åŠ¨", "è‰ºäººå®£ä¼ ", "ðŸ”¥ 3987"] },
  { id: "21", name: "21-eat-restaurant-bootstrap-html5-template", title: "Restaurant Bootstrap Template", keywords: ["é¤é¥®ç¾Žé£Ÿ", "é¤åŽ…è®¢åº§", "å¤–å–æœåŠ¡", "ðŸ”¥ 4567"] },
  { id: "22", name: "22-elegant-free-multi-purpose-bootstrap-responsive-template", title: "Free Multi Template", keywords: ["å©šåº†ç­–åˆ’", "æ´»åŠ¨åº†å…¸", "å®´ä¼šæœåŠ¡", "ðŸ”¥ 3876"] },
  { id: "23", name: "23-enlive-corporate-free-html5-bootstrap-web-template", title: "Corporate Free Template", keywords: ["é›†å›¢å®˜ç½‘", "ä¸Šå¸‚å…¬å¸", "ä¼ä¸šé—¨æˆ·", "ðŸ”¥ 5234"] },
  { id: "24", name: "24-fit-healthy-fitness-and-gym-html5-bootstrap-theme", title: "Healthy Fitness Template", keywords: ["å¥èº«ä¸­å¿ƒ", "ç§æ•™è¯¾ç¨‹", "è¿åŠ¨å¥åº·", "ðŸ”¥ 4789"] },
  { id: "25", name: "25-fitness-zone-html5-bootstrap-responsive-web-template", title: "Zone Html5 Template", keywords: ["ç‘œä¼½èˆžè¹ˆ", "ä½“èƒ½è®­ç»ƒ", "å‡è‚¥å¡‘å½¢", "ðŸ”¥ 4321"] },
  { id: "26", name: "26-frames-corporate-bootstrap-free-html5-template", title: "Corporate Bootstrap Template", keywords: ["é‡‘èžæŠ•èµ„", "å’¨è¯¢æœåŠ¡", "å¾‹å¸ˆäº‹åŠ¡æ‰€", "ðŸ”¥ 3987"] },
  { id: "27", name: "27-free-bootstrap-template-real-estate-my-home", title: "æˆ¿åœ°äº§æ¨¡æ¿", keywords: ["æ¥¼ç›˜å±•ç¤º", "æˆ¿äº§ä¸­ä»‹", "å®¶è£…è®¾è®¡", "ðŸ”¥ 5678"] },
  { id: "28", name: "28-free-bootstrap-template-restaurant-website-treehut", title: "é¤åŽ…ç½‘ç«™æ¨¡æ¿", keywords: ["ä¸»é¢˜é¤åŽ…", "ç¾Žé£ŸæŽ¨è", "åœ¨çº¿è®¢é¤", "ðŸ”¥ 4876"] },
  { id: "29", name: "29-free-bootstrap-template-rockline-business", title: "å•†åŠ¡æ¨¡æ¿", keywords: ["å·¥ä¸šåˆ¶é€ ", "å»ºç­‘å·¥ç¨‹", "è´¸æ˜“å…¬å¸", "ðŸ”¥ 4123"] },
  { id: "30", name: "30-free-portfolio-html5-responsive-website-sam", title: "ä½œå“é›†æ¨¡æ¿", keywords: ["ä¸ªäººç®€åŽ†", "è®¾è®¡ä½œå“", "è‰ºæœ¯åˆ›ä½œ", "ðŸ”¥ 5234"] },
];


const tempPath = "./assets/qinghua-template/spa/";
const tempLink = "./assets/pages/temp.html";

// æ ¹æ®é¡µé¢å†³å®šæ˜¾ç¤ºå…¨éƒ¨è¿˜æ˜¯å‰23ä¸ª
const gridData = templates.slice(0, 13)
  .map((template, index) => ({
    id: index,
    linkurl: `${tempPath}${template.name}/index.html`,
    imgurl: `${tempPath}${template.name}/screenshot.png`,
    title: template.title,
    keywords: template.keywords,
  }));

---

<!-- HTML éƒ¨åˆ† -->
<div class="mainPage">

    <HeaderParallax height="80vh" title="é’èŠ±å“è¶Š">
        <Waves slot="waves" />
        <Menu slot="menu" />
    </HeaderParallax>

  <CardParallax />
  <CardGlass />
  

  <section id="temp">
    <div class="pageSlider">
      <div class="homePage">
        <div class="gridHeader">
          <div class="card"></div>
        </div>
        <div class="detailGrids" id="detailGrids">
          {
            gridData.map((item, index) => (
              <div class="detailGrid" data-index={item.id}>
                <a href={item.linkurl} onClick={(e) => e.stopPropagation()}>
                  <img src={item.imgurl} loading="lazy" alt={item.title} />
                  <div class="imgMask" />
                </a>

                <div class="imgMask"></div>

                <ul class="gridInfo" aria-label="æ¨¡æ¿å…³é”®è¯">
                  {item.keywords.map((keyword) => (
                    <li class="infoKeyword">{keyword}</li>
                  ))}
                </ul>
              </div>
            ))
          }
          <div class="detailGrid enddetailGrid">
            <a href="/templates" aria-label="å‚è€ƒæ›´å¤šå»ºç«™æ¨¡ç‰ˆ">
              âž¤
            </a>
          </div>
        </div>
      </div>
    </div>

    <div class="detailPage">
      <div class="cicleloader-container">
        <iframe src=""></iframe>
        <div class="ripple-loader"></div>
        <div class="bubble-loader"><h3 class="btnText">&lt;</h3></div>
      </div>
    </div>
  </section>
  
  <Footer />

</div>


<!-- style -->
<style>
  :root {
    --bubble-size: 5em;
    --bubble-color-start: #4dabf7;
    --bubble-color-end: #072450;
    --breathe-duration: 2s;
    --ripple-duration: 1.5s;
    --detailPage-move: 0.5s;
    --text-fade-duration: 0.5s;
    --move-duration: 0.5s;
    --easing: cubic-bezier(0.4, 0, 0.6, 1);
    --ripple-easing: cubic-bezier(0.25, 0.1, 0.25, 1);
  }

  .mainPage {
    position: relative;
    width: 100%;
    transition: transform 0.5s ease;
    will-change: transform;
  }

  .pageSlider {
    position: relative;
    width: 100%;
    transition: transform 0.5s ease;
    will-change: transform;
  }

  .pageSlider .gridHeader {
    position: relative;
    width: 100%;
    height: 30vh;
    background-color: rgb(1, 40, 56);
    display: flex;
    align-items: center;
    justify-content: center;
  }


/* From Uiverse.io by csozidev */ 
/* glowing hover card made by: csozi | Website: english.csozi.hu*/

.card {
  position: relative;
  width: 190px;
  height: 254px;
  background: rgb(255, 0, 179);
  background: linear-gradient(137deg, rgb(255, 0, 179) 0%, rgba(0,212,255,1) 100%);
  transition: 0.3s ease;
  border-radius: 30px;
  filter: drop-shadow(0px 0px 30px rgba(209, 38, 197, 0.5));
}

.card::after {
  content: '';
  background-color: #181818;
  position: absolute;
  z-index: 1;
  transition: 0.3s ease;
  height: 98%;
  width: 98%;
  top: 1%;
  left: 1%;
  border-radius: 28px;
}

.card:hover {
  filter: drop-shadow(0px 0px 30px rgba(209, 38, 197, 1));
}


  .pageSlider .detailGrids {
    position: relative;
    width: 80%;
    /* background-color: rgb(112, 165, 42); */
    margin: 0 auto;
    padding: 5em 0;
    display: flex;
    flex-direction: column;
    gap: 1em;
  }

  .pageSlider .gridRow {
    position: relative;
    width: 100%;
    display: flex;
    flex-direction: row;
    gap: 1em;
    /* background-color: rgb(53, 14, 104); */
    border-radius: 1em;
    /* display: none; */
  }


  .detailGrid {
    position: relative;
    flex: 1 1 20%;
    height: 30vh;
    justify-content: center;
    align-items: center;
    /* background-color: #4e0e0e; */
    border-radius: 1em;
    overflow: hidden;
    cursor: pointer;
    transition:
      flex 0.3s ease,
      transform 0.3s ease;
    min-width: 0;
    box-sizing: border-box;
        box-shadow: 0px 1px 2px rgba(0, 0, 0, 0.2), 0px -1px 2px rgba(0, 0, 0, 0.2),
        1px 0px 2px rgba(0, 0, 0, 0.2), -1px 0px 2px rgba(0, 0, 0, 0.2);
  }


  .detailGrid:hover {
    box-shadow: 0px 5px 10px rgba(0, 0, 0, 0.2), 0px -5px 10px rgba(250, 229, 229, 0.2),
            5px 0px 10px rgba(0, 0, 0, 0.2), -5px 0px 10px rgba(0, 0, 0, 0.2);   
  }


.enddetailGrid {
    cursor: pointer;
    transition: all 0.3s ease-in-out;
}

.enddetailGrid>a {
    width: 100%;
    height: 100%;
    display: flex;
    align-items: center;
    justify-content: center;
    text-decoration: none;
    font-size: 2em;
    transition: all 0.3s ease;
}
.enddetailGrid:hover a{
    font-size: 3em;
    color: var(--bubble-color-end);
}

  .detailGrid:hover {
    flex: 1 1 40%;
  }

  .detailGrid img {
    position: relative;
    width: 100%;
    height: 100%;
    object-fit: cover;
    object-position: top;
    pointer-events: none;
    transition: transform 0.3s ease;
  }

.detailGrid .imgMask {
    position: absolute;
    width: 100%;
    height: 100%;
    top: 0;
    left: 0;
    /* background-color: red; */
    background-image: radial-gradient(circle, rgba(0,0,0,0.2) 60%, rgba(0,0,0,0.2) 100%);
    transition: background-image 0.1s linear;
    pointer-events: none;
    z-index: 100;
}

.detailGrid:hover .imgMask {
    background-image: radial-gradient(circle, rgba(0,0,0,0.0) 60%, rgba(0, 0, 0, 0.2) 100%);
}


  .detailGrid ul {
    position: absolute;
    bottom: 0;
    width: 100%;
    height: 3em;
    display: flex;
    flex-direction: row;
    justify-content: center;
    align-items: center;
    text-align: center;
    background-color: rgba(0, 0, 0, 0.8);
    color: rgba(255, 255, 255, 0.8);
    list-style: none;
    padding: 0;
    margin: 0;
  }

  .detailGrid ul li {
    flex: 1;
  }

  .detailPage {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100vh;
    z-index: -1;
    cursor: pointer;
    overflow: hidden;
    opacity: 1;
  }

  .cicleloader-container iframe {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    border: none;
    opacity: 1;
    filter: blur(5px);
    will-change: opacity, filter, clip-path;
    -webkit-clip-path: circle(0 at 50% 50%);
    clip-path: circle(0 at 50% 50%);
    animation:
      clipPathExpand var(--ripple-duration) var(--ripple-easing) forwards,
      fadeIn var(--ripple-duration) var(--ripple-easing) forwards;
    animation-delay: calc(var(--detailPage-move) + 0.1s);
  }

  .cicleloader-container iframe.loaded {
    opacity: 1;
    filter: blur(0);
  }

  .cicleloader-container .ripple-loader {
    position: absolute;
    top: 50%;
    left: 50%;
    width: var(--bubble-size);
    height: var(--bubble-size);
    background: radial-gradient(
      circle,
      transparent 30%,
      var(--bubble-color-start) 60%,
      var(--bubble-color-end) 100%
    );
    border-radius: 50%;
    transform: translate(-50%, -50%) scale(0);
    opacity: 0.7;
    pointer-events: none;
    animation: ripple-loader var(--ripple-duration) var(--ripple-easing)
      forwards;
    animation-delay: calc(var(--detailPage-move) + 0.1s);
    transform-origin: 50% 50%;
  }

  .cicleloader-container .bubble-loader {
    position: absolute;
    display: flex;
    justify-content: center;
    align-items: center;
    top: 50%;
    left: 50%;
    width: var(--bubble-size);
    height: var(--bubble-size);
    animation: breathe-loader var(--breathe-duration) var(--easing) infinite;
    pointer-events: auto;
    cursor: pointer;
    border-radius: 50%;
    background: linear-gradient(
      135deg,
      rgba(255, 255, 255, 0.2),
      rgba(255, 255, 255, 0.05)
    );
    -webkit-backdrop-filter: blur(15px) saturate(200%);
    backdrop-filter: blur(15px) saturate(200%);
    border: 1px solid rgba(255, 255, 255, 0.2);
    box-shadow:
      inset 0 2px 8px rgba(255, 255, 255, 0.15),
      0 4px 12px rgba(0, 0, 0, 0.15),
      0 0 20px rgba(255, 255, 255, 0.1);
    color: #fff;
    text-shadow: 0 1px 2px rgba(0, 0, 0, 0.2);
    text-align: center;
  }

  .cicleloader-container .bubble-loader.loaded {
    position: absolute;
    top: 50%;
    left: 50%;
    width: var(--bubble-size);
    height: var(--bubble-size);
    animation:
      move-to-corner var(--move-duration) var(--easing) forwards,
      liquidGlassBreathe 2.5s cubic-bezier(0.4, 0, 0.2, 1) infinite;
  }

  .cicleloader-container .bubble-loader .btnText {
    color: rgba(0, 0, 0, 0.8);
    font-size: 1.1em;
    font-weight: 500;
  }

  .cicleloader-container .bubble-loader:hover {
    background: linear-gradient(
      135deg,
      rgba(255, 255, 255, 0.3),
      rgba(255, 255, 255, 0.1)
    );
    -webkit-backdrop-filter: blur(15px) saturate(200%);
    backdrop-filter: blur(15px) saturate(200%);
    box-shadow:
      inset 0 2px 8px rgba(255, 255, 255, 0.2),
      0 6px 16px rgba(0, 0, 0, 0.2),
      0 0 24px rgba(255, 255, 255, 0.15);
  }

  .cicleloader-container .loading-text {
    position: relative;
    color: white;
    font-size: 16px;
    pointer-events: none;
    opacity: 1;
    transform: scale(1);
    animation: breathe-text var(--breathe-duration) var(--easing) infinite;
  }

  .cicleloader-container .loaded .loading-text {
    opacity: 0;
    animation: none;
  }

  .cicleloader-container .error-text {
    color: white;
    text-align: center;
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    font-size: 1.5em;
    opacity: 0;
    animation: fadeIn 0.5s ease forwards;
  }

  @keyframes clipPathExpand {
    0% {
      -webkit-clip-path: circle(0 at 50% 50%);
      clip-path: circle(0 at 50% 50%);
    }
    100% {
      -webkit-clip-path: circle(100vmax at 50% 50%);
      clip-path: circle(100vmax at 50% 50%);
    }
  }

  @keyframes ripple-loader {
    0% {
      transform: translate(-50%, -50%) scale(0);
      opacity: 0.7;
    }
    100% {
      transform: translate(-50%, -50%) scale(5);
      width: 100vmax;
      height: 100vmax;
      opacity: 0;
    }
  }

  @keyframes breathe-loader {
    0%,
    100% {
      transform: translate(-50%, -50%) scale(1);
      opacity: 0.8;
    }
    50% {
      transform: translate(-50%, -50%) scale(1.3);
      opacity: 1;
    }
  }

  @keyframes breathe-text {
    0%,
    100% {
      transform: scale(1.1);
      opacity: 1;
    }
    50% {
      transform: scale(0.7);
      opacity: 0.7;
    }
  }

  @keyframes fadeIn {
    to {
      opacity: 1;
    }
  }

  @keyframes move-to-corner {
    0% {
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%) scale(1);
    }
    100% {
      top: 20%;
      left: 20%;
      transform: translate(-50%, -50%) scale(1);
    }
  }

  @keyframes liquidGlassBreathe {
    0% {
      transform: translate(-50%, -50%) scale(1);
      box-shadow:
        inset 0 2px 8px rgba(255, 255, 255, 0.15),
        0 4px 12px rgba(0, 0, 0, 0.15),
        0 0 20px rgba(255, 255, 255, 0.1);
      background: linear-gradient(
        135deg,
        rgba(255, 255, 255, 0.2),
        rgba(255, 255, 255, 0.05)
      );
    }
    50% {
      transform: translate(-50%, -50%) scale(1.03);
      box-shadow:
        inset 0 3px 10px rgba(255, 255, 255, 0.25),
        0 6px 16px rgba(0, 0, 0, 0.2),
        0 0 28px rgba(255, 255, 255, 0.15);
      background: linear-gradient(
        135deg,
        rgba(255, 255, 255, 0.25),
        rgba(255, 255, 255, 0.08)
      );
    }
    100% {
      transform: translate(-50%, -50%) scale(1);
      box-shadow:
        inset 0 2px 8px rgba(255, 255, 255, 0.15),
        0 4px 12px rgba(0, 0, 0, 0.15),
        0 0 20px rgba(255, 255, 255, 0.1);
      background: linear-gradient(
        135deg,
        rgba(255, 255, 255, 0.2),
        rgba(255, 255, 255, 0.05)
      );
    }
  }
</style>

<script type="module" client:load>
  class SliderDetailGrid {
    constructor() {
      this.rootUrl = window.location.origin + window.location.pathname;
      this.tempPath = "./assets/qinghua-template/spa/";
      this.tempLink = "./assets/pages/temp.html";
      this.pageSlider = document.querySelector(".pageSlider");
      this.mainPage = document.querySelector(".mainPage");
      this.detailGrids = document.querySelector(".detailGrids");
      this.detailGrid = this.detailGrids.querySelectorAll(".detailGrid")

      this.detailPage = document.querySelector(".detailPage");
      this.cicleloaderContainer = this.detailPage.querySelector(".cicleloader-container");
      this.iframe = document.querySelector(".detailPage iframe");
      this.bubbleLoader = this.detailPage.querySelector(".bubble-loader");
      this.rippleLoader = this.detailPage.querySelector(".ripple-loader");

      this.state = { viewer: "mainView", detailGrid: {} };

      const astroAttr = Array.from(this.detailGrids.attributes).find((attr) =>
        attr.name.startsWith("data-astro-cid"),
      );
      this.astroCidAttr = astroAttr?.name || null;

      if (!this.mainPage || !this.detailGrids || !this.detailPage) {
        console.error("Required DOM elements are missing.");
        return;
      }

      this.init();
    }

    init() {
      this.reRow();
      this.reconfig();
      this.bindEvents();
      if (location.hash.startsWith("#detailView")) {
        this.onHashChange();
      }
    }

    reRow() {
      var gw = 300;
      const gridsWidth = this.detailGrids.clientWidth;
      const gridGap = parseFloat(getComputedStyle(this.detailGrids).gap) || 16;
      const perRow = Math.min(Math.max(Math.floor(gridsWidth / gw), 2), 5);
      const grids = Array.from(this.detailGrid,);
      this.detailGrids.innerHTML = "";

      for (let i = 0; i < grids.length; i += perRow) {
        const gridRow = document.createElement("div");
        gridRow.className = `gridRow gridRow-${i / perRow}`;
        if (this.astroCidAttr) {
          gridRow.setAttribute(this.astroCidAttr, "");
        }
        const rowItems = grids.slice(i, i + perRow);
        const widthPerGrid = (gridsWidth - (perRow - 1) * gridGap) / perRow;
        rowItems.forEach((grid) => {
          gridRow.appendChild(grid);
        });
        this.detailGrids.appendChild(gridRow);
      }

    }

    reconfig() {
      if (this.rootUrl.includes("temp.html")) {
        const endGrid = this.detailGrids.querySelector(".enddetailGrid");
        if (endGrid) {
          endGrid.innerHTML =
            '<a href="/" aria-label="Back to home"> < å›žåˆ°é¦–é¡µ </a>';
        }
      }
      if (this.rootUrl.includes("pages")) {
        const headerTitle = document.querySelector(".header-content");
        if (headerTitle) {
          headerTitle.style.height = "30vh";
        }
      }
    }


    


    bindEvents() {
      window.addEventListener("resize", () => this.reRow());
      window.addEventListener("popstate", (e) => this.handlePopState(e));
      window.addEventListener("hashchange", () => this.onHashChange());

      this.bubbleLoader.addEventListener("click", (e) => {
        this.navigateTo("mainView");
      });

     
      this.detailGrids
        .querySelectorAll(".detailGrid:not(.enddetailGrid)")
        .forEach((grid) => {
          grid.addEventListener("click", (e) => {
            const index = parseInt(grid.dataset.index, 10);
            const linkurl = grid.querySelector("a").href;
            const imgurl = grid.querySelector("img").src;
            const enterFrom =
              e.clientX < window.innerWidth / 2 ? "left" : "right";
            sessionStorage.setItem("lastEnterFrom", enterFrom);

            this.setState({
              viewer: "detailView",
              detailGrid: { index, linkurl, imgurl, enterFrom },
            });

            this.navigateTo("detailView");
          });
        });
    }

    setState(update) {
      this.state = { ...this.state, ...update };
    }

    navigateTo(view) {
      if (view === "detailView") {
        const { index, enterFrom, linkurl, imgurl } = this.state.detailGrid;
        history.pushState(
          { view, index, enterFrom, linkurl, imgurl },
          "",
          `#detailView/template/${index + 1}`,
        );
        this.goToDetail();
      } else {
        history.pushState({ view: "mainView" }, "", this.rootUrl);
        this.goToMain();
      }
    }

    goToDetail() {
      this.detailPage.style.opacity = 1;
      const { index, perRow, imgurl, linkurl, enterFrom } =
        this.state.detailGrid;

      // é‡ç½®æ‰€æœ‰å…ƒç´ çŠ¶æ€
      this.cicleloaderContainer.innerHTML = "";
      this.iframe.classList.remove("loaded");
      this.rippleLoader.classList.remove("active");
      this.bubbleLoader.classList.remove("loaded");

      // é‡æ–°æ·»åŠ å…ƒç´ 
      this.cicleloaderContainer.appendChild(this.iframe);
      this.cicleloaderContainer.appendChild(this.rippleLoader);
      this.cicleloaderContainer.appendChild(this.bubbleLoader);

      this.iframe.src = linkurl;

      // åˆ›å»ºæ–°çš„åŠ¨ç”»ç»“æŸå¤„ç†å‡½æ•°ï¼ˆé¿å…é‡å¤ç»‘å®šï¼‰
      const handleAnimationEnd = () => {
        this.bubbleLoader.classList.add("loaded");
        this.rippleLoader.removeEventListener(
          "animationend",
          handleAnimationEnd,
        );
      };

      this.iframe.addEventListener("load", () => {
        this.iframe.classList.add("loaded");
        this.rippleLoader.classList.add("active");
        this.rippleLoader.addEventListener("animationend", handleAnimationEnd, {
          once: true,
        });
      });

      document.body.style.overflow = "hidden";
      this.detailPage.style.transform = `translateY(${window.scrollY}px)`;

      if (enterFrom === "left") {
        this.detailPage.style.left = "-100%";
        this.mainPage.style.transform = "translateX(100%)";
      } else {
        this.detailPage.style.left = "100%";
        this.mainPage.style.transform = "translateX(-100%)";
      }
    }

    goToMain() {
      this.setState({ viewer: "mainView" });
      document.body.style.overflow = "";
      this.mainPage.style.transform = "translateX(0)";

      setTimeout(() => {
        this.iframe.src = "";
        this.cicleloaderContainer.innerHTML = "";
      }, 1000);
    }

    handlePopState(event) {
      const state = event.state || { view: "mainView" };
      if (state.view === "mainView") {
        this.goToMain();
      } else if (state.view === "detailView") {
        const enterFrom =
          state.enterFrom || sessionStorage.getItem("lastEnterFrom") || "right";
        this.setState({
          viewer: "detailView",
          detailGrid: { ...state, enterFrom },
        });
        this.goToDetail();
      }
    }

    onHashChange() {
      const hash = location.hash.slice(1);
      const parts = hash.split("/");
      if (parts[0] !== "detailView") {
        this.goToMain();
        return;
      }

      const index = parseInt(parts[2], 10) - 1;
      if (
        isNaN(index) ||
        index < 0 ||
        index >=
          this.detailGrids.querySelectorAll(".detailGrid:not(.enddetailGrid)")
            .length
      ) {
        this.goToMain();
        return;
      }

      const grid = this.detailGrids.querySelector(
        `.detailGrid[data-index="${index}"]`,
      );
      if (!grid) {
        this.goToMain();
        return;
      }

      const linkurl = grid.querySelector("a").href;
      const imgurl = grid.querySelector("img").src;
      const enterFrom = sessionStorage.getItem("lastEnterFrom") || "right";
      this.setState({
        viewer: "detailView",
        detailGrid: { index, linkurl, imgurl, enterFrom },
      });
      this.goToDetail();
    }
  }

  const gallery = new SliderDetailGrid();
</script>
